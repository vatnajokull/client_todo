<md-dialog aria-label="Add Comment" class="commments-popup">
  <md-toolbar>
    <div class="md-toolbar-tools">
      <h2>Add Comment</h2>
      <span flex></span>
      <md-button class="md-icon-button" ng-click="vm.cancel()">
        <md-icon aria-label="Close dialog">
          <i class="fa fa-times fa-lg" aria-hidden="true"></i>
        </md-icon>
      </md-button>
    </div>
  </md-toolbar>

  <md-dialog-content ng-cloak="">
    <div class="md-dialog-content">
      <div class="comments-wrapper" ng-cloak="">
        <!-- Add new comment form -->
        <div class="add-new-comment">
          <form ng-submit="vm.newCommentResolver(vm.newComment, commentForm)" role="form" name="commentForm" >
            <div class="textarea">
              <md-input-container class="md-block">
                <textarea ng-model="vm.newComment.body" name="body" minlength="10" md-maxlength="256" maxlength="256" rows="3" md-select-on-focus placeholder="Enter Your Comment" required></textarea>
                <div ng-messages="commentForm.body.$error">
                  <div ng-message="required">This is required!</div>
                </div>
              </md-input-container>              
              <div class="attachment-icon">
                <input class="ng-hide" type="file" ngf-select ng-model="vm.newComment.attachment" id="uploaderInput" name="attachment" accept="image/jpeg,image/png" ngf-max-size="10MB" ngf-model-invalid="errorFile" />                 
                <label for="uploaderInput">
                  <i class="fa fa-paperclip fa-lg" aria-hidden="true"></i>
                </label>               
              </div>
              <!-- image preview -->
              <i class="error" ng-show="commentForm.attachment.$error.maxSize">An uploaded file is too large. The size shouldnâ€™t exceed 10 MB.</i>
              <div ng-show="vm.newComment.attachment" class="image-preview">
                <img ng-show="commentForm.attachment.$valid" ngf-thumbnail="vm.newComment.attachment" class="thumb">
                <a class="delete-attachment" href="">                
                  <i ng-click="vm.newComment.attachment = null" class="fa fa-times fa-lg" aria-hidden="true"></i>
                </a>                
              </div>              
            </div>            
           <div class="action-buttons">
             <md-button type="submit" name="button" class="md-raised md-primary">Save</md-button>
             <md-button type="button" ng-click="vm.cancel()">Cancel</md-button>
           </div>
          </form>
        </div>

        <md-divider></md-divider>
        <!-- comment body -->
        <div ng-show="vm.progressBar.load || vm.progressBar.upload" layout="row" layout-sm="column" layout-align="space-around">
          <md-progress-circular md-mode="indeterminate"></md-progress-circular>
        </div>
        <div ng-hide="vm.progressBar.load" class="comment" ng-repeat="comment in vm.comments">
          <div class="comment-header">
            <span class="comment-created-at">{{comment.createdAt | date : 'MM/dd/yyyy'}}</span>
            <a ng-click="vm.removeComment(comment)" href="javascript:void(0)">
              <i class="fa fa-trash" aria-hidden="true"></i>
            </a>
          </div>
          <div class="comment-body">
            {{comment.body}}            
          </div>          
          <div class="comment-attachment" ng-hide="comment.attachment.url === null">
            <a href="{{comment.attachment.url}}" target="_blank">
              <img ng-src="{{comment.attachment.thumb.url}}">  
            </a>            
          </div>          
        </div>
      </div>
    </div>
  </md-dialog-content>

</md-dialog>
